# -*- coding: utf-8 -*-
from db import SessionLocal, Site
from datetime import datetime

SITES = [
    "مبنى الزبيري - مولد","مخازن الزبيري","السعدي عصر","كهرباء عصر","عصر-2","عصر-3","سوق عصر",
    "الخمسين-1","الخمسين-2","نوارة الستين","السنينة-1","السنينة-2","السنينة-3","السنينة-4","السنينة-5","السنينة-6","السنينة-7",
    "جامعة العلوم والتكنولوجيا","كلية الهندسة جامعة العلوم","حي الأندلس","فندف الفاف","الستين","الأكوع شارع الستين",
    "سوق الأمانة-1","سوق الأمانة-3","سوق مذبح","مذبح-2","مذبح-3","مذبح-4","مذبح-5","مذبح-6","مذبح-7","مذبح-8",
    "الثلاثين-1","الثلاثين-2","الثلاثين-3","الثلاثين-4","جولة المنعي","شملان الضرائب-1","شملان الضرائب-2","شملان الضرائب-3",
    "شملان-1","شملان-2","شملان-3","شملان-4","شملان-5","شملان-6","شملان-7","شملان-8","جولة شملان","مصنع شملان",
    "حي الطيارين","الجوية-1","الجوية-2","الجوية-3","الجوية-5","حي الأعناب","صوفان","الملعب-2",
    "السعودي الألماني-1","السعودي الألماني-2","فندق جي ستار","دارس-1","دارس-2","دارس-3","دارس-5","دارس-6",
    "وادي أحمد-1","وادي أحمد-2","جولة عمران","حي سنان","الأدلة الجنائية-1","الأدلة الجنائية-2",
    "ذهبان-1","ذهبان-2","ذهبان-3","ذهبان-4","ذهبان-5","ذهبان-6",
    "جدر-1","جدر-2","جدر-3","جدر-4","جدر-5","جدر-6","جدر-7","سوق جدر","حي الحظن",
    "العميري-1","العميري-2","العميري-3","العميري-4","العميري-5","قرية القابل","العره همدان","غيل همدان",
    "قرية ضلاع","سنترال ضلاع","ضلاع-2","ضلاع-3","ضلاع-4","ضلاع-5","ضلاع-6","شاهرة ضلاع","بيت أنعم","بيت عذران",
    "الجبل الأسود","قيفان","بني منصور","بيت الشيبة","جبل الصعود","جبل العوي","العرشان","جبل ريام","جبل ظين","ثلا","جبل الطرف"
]

DEFAULT_REGION = "الأمانة"

def main():
    seen = set()
    clean = []
    for name in SITES:
        if name not in seen:
            seen.add(name)
            clean.append(name)

    with SessionLocal() as s:
        inserted = 0
        for name in clean:
            exists = s.query(Site).filter(Site.name == name).first()
            if not exists:
                s.add(Site(name=name, region=DEFAULT_REGION, created_at=datetime.utcnow()))
                inserted += 1
        s.commit()
        print(f"Sites inserted: {inserted}")
        print(f"Total in DB: {s.query(Site).count()}")

if __name__ == "__main__":
    main()
